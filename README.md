To be continued ...
or maybe not, PHP sucks
this is a complete mess
